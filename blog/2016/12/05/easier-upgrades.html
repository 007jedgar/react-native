<!DOCTYPE html><html><head><title>Easier Upgrades Thanks to Git</title><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width"><meta property="fb:app_id" content="1677033832619985"><meta property="fb:admins" content="121800083"><meta property="og:site_name" content="React Native"><meta property="og:title" content="Easier Upgrades Thanks to Git"><meta property="og:url" content="https://facebook.github.io/react-native/blog/2016/12/05/easier-upgrades.html"><meta property="og:image" content="https://facebook.github.io/react-native/img/opengraph.png"><meta property="og:description" content="Upgrading to new versions of React Native has been difficult. You might have seen something like this before:"><meta name="twitter:site" content="@reactnative"><meta name="twitter:card" content="summary_large_image"><meta property="og:type" content="article"><meta property="article:author" content="Nicolas Cuillery"><meta name="twitter:creator" content="@ncuillery"><base href="/react-native/releases/next/"><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"><link rel="shortcut icon" href="img/favicon.png?2"><link rel="stylesheet" href="css/react-native.css"><link rel="stylesheet" href="css/prism.css"><link rel="alternate" type="application/rss+xml" title="React Native Blog" href="https://facebook.github.io/react-native/blog/feed.xml"><link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="//use.typekit.net/vqa1hcx.js"></script><script type="text/javascript">try{Typekit.load();}catch(e){}</script></head><body><script>window.fbAsyncInit = function() {FB.init({appId:'1677033832619985',xfbml:true,version:'v2.7'});};(function(d, s, id){var js, fjs = d.getElementsByTagName(s)[0];if (d.getElementById(id)) {return;}js = d.createElement(s); js.id = id;js.src = '//connect.facebook.net/en_US/sdk.js';fjs.parentNode.insertBefore(js, fjs);}(document, 'script','facebook-jssdk'));</script><script>window.twttr=(function(d,s, id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return t;js=d.createElement(s);js.id=id;js.src='https://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js, fjs);t._e = [];t.ready = function(f) {t._e.push(f);};return t;}(document, 'script', 'twitter-wjs'));</script><div class="container"><div class="nav-main"><div class="wrap"><a class="nav-home" href=""><img src="img/header_logo.png">React Native</a><a class="nav-version" href="/react-native/versions.html">next</a><div class="nav-site-wrapper"><ul class="nav-site nav-site-internal"><li><a href="docs/getting-started.html" class="" data-target=".nav-docs">Docs</a></li><li><a href="/react-native/support.html" class="">Help</a></li><li><a href="/react-native/blog/" class="active">Blog</a></li></ul><div class="algolia-search-wrapper"><input id="algolia-doc-search" tabindex="0" type="text" placeholder="Search docs..."></div><ul class="nav-site nav-site-external"><li><a href="https://github.com/facebook/react-native" class="">GitHub</a></li><li><a href="http://facebook.github.io/react" class="">React</a></li></ul></div></div></div><section class="content wrap documentationContent"><article class="entry-body"><header class="entry-header"><h4 class="entry-authordate"><a href="https://twitter.com/ncuillery" target="_blank" class="author">Nicolas Cuillery</a> â€” <time class="date">December 5, 2016</time></h4><h1 class="entry-title">Easier Upgrades Thanks to Git</h1></header><div class="entry-content"><div><p>Upgrading to new versions of React Native has been difficult. You might have seen something like this before:</p><p><img src="/react-native/blog/img/git-upgrade-conflict.png" alt=""></p><p>None of those options is ideal. By overwriting the file we lose our local changes. By not overwriting we don&#x27;t get the latest updates.</p><p>Today I am proud to introduce a new tool that helps solve this problem. The tool is called <code>react-native-git-upgrade</code> and uses Git behind the scenes to resolve conflicts automatically whenever possible.</p><h2><a class="anchor" name="usage"></a>Usage <a class="hash-link" href="#usage">#</a></h2><blockquote><p><strong>Requirement</strong>: Git has to be available in the <code>PATH</code>. Your project doesn&#x27;t have to be managed by Git.</p></blockquote><p>Install <code>react-native-git-upgrade</code> globally:</p><div class="prism language-shell">$ npm install <span class="token operator">-</span>g react<span class="token operator">-</span>native<span class="token operator">-</span>git<span class="token operator">-</span>upgrade</div><p>or, using <a href="https://yarnpkg.com/" target="_blank">Yarn</a>:</p><div class="prism language-shell">$ yarn global add react<span class="token operator">-</span>native<span class="token operator">-</span>git<span class="token operator">-</span>upgrade</div><p>Then, run it inside your project directory:</p><div class="prism language-shell">$ cd MyProject
$ react<span class="token operator">-</span>native<span class="token operator">-</span>git<span class="token operator">-</span>upgrade <span class="token number">0.38</span><span class="token punctuation">.</span><span class="token number">0</span></div><blockquote><p>Note: Do <strong>not</strong> run &#x27;npm install&#x27; to install a new version of <code>react-native</code>. The tool needs to be able to compare the old and new project template to work correctly. Simply run it inside your app folder as shown above, while still on the old version.</p></blockquote><p>Example output:</p><p><img src="/react-native/blog/img/git-upgrade-output.png" alt=""></p><p>You can also run <code>react-native-git-upgrade</code> with no arguments to upgrade to the latest version of React Native.</p><p>We try to preserve your changes in iOS and Android build files, so you don&#x27;t need to run <code>react-native link</code> after an upgrade.</p><p>We have designed the implementation to be as little intrusive as possible. It is entirely based on a local Git repository created on-the-fly in a temporary directory. It won&#x27;t interfere with your project repository (no matter what VCS you use: Git, SVN, Mercurial, ... or none). Your sources are restored in case of unexpected errors.</p><h2><a class="anchor" name="how-does-it-work"></a>How does it work? <a class="hash-link" href="#how-does-it-work">#</a></h2><p>The key step is generating a Git patch. The patch contains all the changes made in the React Native templates between the version your app is using and the new version.</p><p>To obtain this patch, we need to generate an app from the templates embedded in the <code>react-native</code> package inside your <code>node_modules</code> directory (these are the same templates the <code>react-native init</code> commands uses). Then, after the native apps have been generated from the templates in both the current version and the new version, Git is able to produce a patch that is adapted to your project (i.e. containing your app name):</p><div class="prism language-javascript"><span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span>

diff <span class="token operator">--</span>git a<span class="token operator">/</span>ios<span class="token operator">/</span>MyAwesomeApp<span class="token operator">/</span>Info<span class="token punctuation">.</span>plist b<span class="token operator">/</span>ios<span class="token operator">/</span>MyAwesomeApp<span class="token operator">/</span>Info<span class="token punctuation">.</span>plist
index e98ebb0<span class="token punctuation">.</span><span class="token punctuation">.</span>2fb6a11 <span class="token number">100644</span>
<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>ios<span class="token operator">/</span>MyAwesomeApp<span class="token operator">/</span>Info<span class="token punctuation">.</span>plist
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>ios<span class="token operator">/</span>MyAwesomeApp<span class="token operator">/</span>Info<span class="token punctuation">.</span>plist
@@ <span class="token operator">-</span><span class="token number">45</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">45</span><span class="token punctuation">,</span><span class="token number">7</span> @@
         <span class="token operator">&lt;</span>dict<span class="token operator">&gt;</span>
             <span class="token operator">&lt;</span>key<span class="token operator">&gt;</span>localhost<span class="token operator">&lt;</span><span class="token operator">/</span>key<span class="token operator">&gt;</span>
             <span class="token operator">&lt;</span>dict<span class="token operator">&gt;</span>
<span class="token operator">-</span>                <span class="token operator">&lt;</span>key<span class="token operator">&gt;</span>NSTemporaryExceptionAllowsInsecureHTTPLoads<span class="token operator">&lt;</span><span class="token operator">/</span>key<span class="token operator">&gt;</span>
<span class="token operator">+</span>                <span class="token operator">&lt;</span>key<span class="token operator">&gt;</span>NSExceptionAllowsInsecureHTTPLoads<span class="token operator">&lt;</span><span class="token operator">/</span>key<span class="token operator">&gt;</span>
                 <span class="token operator">&lt;</span><span class="token boolean">true</span><span class="token operator">/</span><span class="token operator">&gt;</span>
             <span class="token operator">&lt;</span><span class="token operator">/</span>dict<span class="token operator">&gt;</span>
         <span class="token operator">&lt;</span><span class="token operator">/</span>dict<span class="token operator">&gt;</span>
<span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span></div><p>All we need now is to apply this patch to your source files. While the old <code>react-native upgrade</code> process would have prompted you for any small difference, Git is able to merge most of the changes automatically using its 3-way merge algorithm and eventually leave us with familiar conflict delimiters:</p><div class="prism language-javascript">        13B07F951A680F5B00A75B9A <span class="token comment" spellcheck="true">/* Release */</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
            isa <span class="token operator">=</span> XCBuildConfiguration<span class="token punctuation">;</span>
            buildSettings <span class="token operator">=</span> <span class="token punctuation">{</span>
                ASSETCATALOG_COMPILER_APPICON_NAME <span class="token operator">=</span> AppIcon<span class="token punctuation">;</span>
<span class="token operator">&lt;&lt;</span><span class="token operator">&lt;&lt;</span><span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span> ours
                CODE_SIGN_IDENTITY <span class="token operator">=</span> <span class="token string">&quot;iPhone Developer&quot;</span><span class="token punctuation">;</span>
                FRAMEWORK_SEARCH_PATHS <span class="token operator">=</span> <span class="token punctuation">(</span>
                    <span class="token string">&quot;$(inherited)&quot;</span><span class="token punctuation">,</span>
                    <span class="token string">&quot;$(PROJECT_DIR)/HockeySDK.embeddedframework&quot;</span><span class="token punctuation">,</span>
                    <span class="token string">&quot;$(PROJECT_DIR)/HockeySDK-iOS/HockeySDK.embeddedframework&quot;</span><span class="token punctuation">,</span>
                <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">===</span><span class="token operator">===</span><span class="token operator">=</span>
                CURRENT_PROJECT_VERSION <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token operator">&gt;&gt;&gt;</span><span class="token operator">&gt;&gt;&gt;</span><span class="token operator">&gt;</span> theirs
                HEADER_SEARCH_PATHS <span class="token operator">=</span> <span class="token punctuation">(</span>
                    <span class="token string">&quot;$(inherited)&quot;</span><span class="token punctuation">,</span>
                    <span class="token operator">/</span>Applications<span class="token operator">/</span>Xcode<span class="token punctuation">.</span>app<span class="token operator">/</span>Contents<span class="token operator">/</span>Developer<span class="token operator">/</span>Toolchains<span class="token operator">/</span>XcodeDefault<span class="token punctuation">.</span>xctoolchain<span class="token operator">/</span>usr<span class="token operator">/</span>include<span class="token punctuation">,</span>
                    <span class="token string">&quot;$(SRCROOT)/../node_modules/react-native/React/**&quot;</span><span class="token punctuation">,</span>
                    <span class="token string">&quot;$(SRCROOT)/../node_modules/react-native-code-push/ios/CodePush/**&quot;</span><span class="token punctuation">,</span>
                <span class="token punctuation">)</span><span class="token punctuation">;</span></div><p>These conflicts are generally easy to reason about. The delimiter <strong>ours</strong> stands for &quot;your team&quot; whereas <strong>theirs</strong> could be seen as &quot;the React Native team&quot;.</p><h2><a class="anchor" name="why-introduce-a-new-global-package"></a>Why introduce a new global package? <a class="hash-link" href="#why-introduce-a-new-global-package">#</a></h2><p>React Native comes with a global CLI (the <a href="https://www.npmjs.com/package/react-native-cli" target="_blank">react-native-cli</a> package) which delegates commands to the local CLI embedded in the <code>node_modules/react-native/local-cli</code> directory.</p><p>As we mentioned above, the process has to be started from your current React Native version. If we had embedded the implementation in the local-cli, you wouldn&#x27;t be able to enjoy this feature when using old versions of React Native. For example, you wouldn&#x27;t be able to upgrade from 0.29.2 to 0.38.0 if this new upgrade code was only released in 0.38.0.</p><p>Upgrading based on Git is a big improvement in developer experience and it is important to make it available to everyone. By using a separate package <a href="https://www.npmjs.com/package/react-native-git-upgrade" target="_blank">react-native-git-upgrade</a> installed globally you can use this new code today no matter what version of React Native your project is using.</p><p>One more reason is the recent <a href="https://twitter.com/martinkonicek/status/800730190141857793" target="_blank">Yeoman wipeout</a> by Martin Konicek. We didn&#x27;t want to get these Yeoman dependencies back into the <code>react-native</code> package to be able to evaluate the old template in order to create the patch.</p><h2><a class="anchor" name="try-it-out-and-provide-feedback"></a>Try it out and provide feedback <a class="hash-link" href="#try-it-out-and-provide-feedback">#</a></h2><p>As a conclusion, I would say, enjoy the feature and feel free <a href="https://github.com/facebook/react-native/issues" target="_blank">to suggest improvements, report issues</a> and especially <a href="https://github.com/facebook/react-native/pulls" target="_blank">send pull requests</a>. Each environment is a bit different and each React Native project is different, and we need your feedback to make this work well for everyone.</p><h3><a class="anchor" name="thank-you"></a>Thank you! <a class="hash-link" href="#thank-you">#</a></h3><p>I would like to thank the awesome companies <a href="http://www.zenika.com" target="_blank">Zenika</a> and <a href="http://www.groupem6.fr/le-groupe_en/activites/diversifications/m6-web.html" target="_blank">M6 Web</a> without whom none of this would have been possible!</p></div></div><div><aside class="author-info"><div class="author-image"><span class="the-image" style="background-image:url(https://fr.gravatar.com/userimage/78328995/184460def705a160fd8edadc04f60eaf.jpg?size=128);"></span></div><p class="posted-on">Posted on <time class="date">December 5, 2016</time></p><p class="name-title"><a href="https://twitter.com/ncuillery" target="_blank">Nicolas Cuillery</a>, <span class="title">JavaScript consultant and trainer at Zenika</span></p></aside><aside class="entry-share"><h3 class="small-title">Share this post</h3><div class="social-buttons"><div class="fb-like" data-layout="standard" data-share="true" data-width="225" data-show-faces="false"></div><a href="https://twitter.com/share" class="twitter-share-button" data-text="Easier Upgrades Thanks to Git" data-url="http://facebook.github.io/react-native/blog/2016/12/05/easier-upgrades.html" data-via="ncuillery" data-related="reactnative" data-show-count="false">Tweet</a></div></aside></div></article></section><footer class="nav-footer"><section class="sitemap"><a href="/react-native" class="nav-home"><img src="img/header_logo.png" alt="React Native" width="66" height="58"></a><div><h5><a href="docs/">Docs</a></h5><a href="docs/getting-started.html">Getting Started</a><a href="docs/tutorial.html">Learn the Basics</a><a href="docs/components-and-apis.html">Components and APIs</a><a href="docs/more-resources.html">More Resources</a></div><div><h5><a href="/react-native/support.html">Community</a></h5><a href="/react-native/showcase.html">Who&#x27;s using React Native?</a><a href="http://www.meetup.com/topics/react-native/" target="_blank">Meetups</a><a href="https://www.facebook.com/groups/react.native.community" target="_blank">Facebook Group</a><a href="https://twitter.com/reactnative" target="_blank">Twitter</a></div><div><h5><a href="/react-native/support.html">Help</a></h5><a href="http://stackoverflow.com/questions/tagged/react-native" target="_blank">Stack Overflow</a><a href="https://discord.gg/0ZcbPKXt5bZjGY5n">Reactiflux Chat</a><a href="/react-native/versions.html" target="_blank">Latest Releases</a><a href="https://react-native.canny.io/feature-requests" target="_blank">Feature Requests</a></div><div><h5>More</h5><a href="/react-native/blog">Blog</a><a href="http://facebook.github.io/react/" target="_blank">React</a><a href="https://github.com/facebook/react-native" target="_blank">GitHub</a><div class="githubButton"><a class="github-button" href="https://github.com/facebook/react-native" data-icon="octicon-star" data-count-href="/facebook/react-native/stargazers" data-count-api="/repos/facebook/react-native#stargazers_count" data-count-aria-label="# stargazers on GitHub" aria-label="Star facebook/react-native on GitHub">Star</a></div></div></section><section class="newsletter"><div id="mc_embed_signup"><form action="//reactnative.us10.list-manage.com/subscribe/post?u=db0dd948e2b729ee62625b1a8&amp;id=47cd41008f" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate><div id="mc_embed_signup_scroll"><label for="mce-EMAIL"><h5>Get the React Native Newsletter</h5></label><input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required><div style="position:absolute;left:-5000px;" aria-hidden="true"><input type="text" name="b_db0dd948e2b729ee62625b1a8_47cd41008f" tabindex="-1" value=""></div><div class="clear"><input type="submit" value="Sign up" name="subscribe" id="mc-embedded-subscribe" class="button"></div></div></form></div></section><a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource"><img src="img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"></a><section class="copyright">Copyright Â© 2017 Facebook Inc.</section></footer></div><div id="fb-root"></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
            ga('create', 'UA-41298772-2', 'facebook.github.io');
            ga('send', 'pageview');

            !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)
            ){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";
            fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");

            docsearch({
              apiKey: '2c98749b4a1e588efec53b2acec13025',
              indexName: 'react-native-versions',
              inputSelector: '#algolia-doc-search',
              algoliaOptions: { facetFilters: [ "tags:master" ], hitsPerPage: 5 }
            });
          </script><script src="js/scripts.js"></script><script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';fnames[1]='FNAME';ftypes[1]='text';fnames[2]='LNAME';ftypes[2]='text';}(jQuery));var $mcj = jQuery.noConflict(true);</script><script type="text/javascript" src="https://snack.expo.io/embed.js"></script><script async defer src="https://buttons.github.io/buttons.js"></script></body></html>