<!DOCTYPE html><html><head><title>Easy upgrades, relying on Git</title><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width"><meta property="fb:app_id" content="1677033832619985"><meta property="fb:admins" content="121800083"><meta property="og:site_name" content="React Native"><meta property="og:title" content="Easy upgrades, relying on Git"><meta property="og:url" content="https://facebook.github.io/react-native/blog/2016/12/05/easy-upgrades-processed-by-git.html"><meta property="og:image" content="https://facebook.github.io/react-native/img/opengraph.png"><meta property="og:description" content="Each release of React Native may come with changes inside the iOS and Android sub-projects that you have to report in your project. This synchronisation has always been a major pain point because of the poor changes detection within your source files. Today, I&#x27;m proud to announce a new upgrading process relying on the most popular version control system: Git."><meta name="twitter:site" content="@reactnative"><meta name="twitter:card" content="summary_large_image"><meta property="og:type" content="article"><meta property="article:author" content="Nicolas Cuillery"><meta name="twitter:creator" content="@ncuillery"><base href="/react-native/releases/next/"><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"><link rel="shortcut icon" href="img/favicon.png?2"><link rel="stylesheet" href="css/react-native.css"><link rel="alternate" type="application/rss+xml" title="React Native Blog" href="https://facebook.github.io/react-native/blog/feed.xml"><link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="//use.typekit.net/vqa1hcx.js"></script><script type="text/javascript">try{Typekit.load();}catch(e){}</script></head><body><script>window.fbAsyncInit = function() {FB.init({appId:'1677033832619985',xfbml:true,version:'v2.7'});};(function(d, s, id){var js, fjs = d.getElementsByTagName(s)[0];if (d.getElementById(id)) {return;}js = d.createElement(s); js.id = id;js.src = '//connect.facebook.net/en_US/sdk.js';fjs.parentNode.insertBefore(js, fjs);}(document, 'script','facebook-jssdk'));</script><script>window.twttr=(function(d,s, id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return t;js=d.createElement(s);js.id=id;js.src='https://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js, fjs);t._e = [];t.ready = function(f) {t._e.push(f);};return t;}(document, 'script', 'twitter-wjs'));</script><div class="container"><div class="nav-main"><div class="wrap"><a class="nav-home" href=""><img src="img/header_logo.png">React Native</a><a class="nav-version" href="/react-native/versions.html">next</a><div class="nav-site-wrapper"><ul class="nav-site nav-site-internal"><li><a href="docs/getting-started.html" class="" data-target=".nav-docs">Docs</a></li><li><a href="/react-native/support.html" class="">Help</a></li><li><a href="/react-native/showcase.html" class="">Showcase</a></li><li><a href="/react-native/blog/" class="active">Blog</a></li></ul><div class="algolia-search-wrapper"><input id="algolia-doc-search" tabindex="0" type="text" placeholder="Search docs..."></div><ul class="nav-site nav-site-external"><li><a href="https://github.com/facebook/react-native" class="">GitHub</a></li><li><a href="http://facebook.github.io/react" class="">React</a></li></ul></div></div></div><div class="hero"><div class="wrap"><div class="text"><strong>React Native Blog</strong></div><div class="minitext">Stay up-to-date with the latest React Native news and events.</div></div></div><section class="content wrap documentationContent"><article class="entry-body"><header class="entry-header"><h4 class="entry-authordate"><a href="https://twitter.com/ncuillery" target="_blank" class="author">Nicolas Cuillery</a> â€” <time class="date">December 5, 2016</time></h4><h1 class="entry-title">Easy upgrades, relying on Git</h1></header><div class="entry-content"><div><p>Each release of React Native may come with changes inside the iOS and Android sub-projects that you have to report in your project. This synchronisation has always been a major pain point because of the poor changes detection within your source files. Today, I&#x27;m proud to announce a new upgrading process relying on the most popular version control system: Git.</p><p>The key concept in this operation is the generation of a Git patch that contains all the changes required by React Native from your current version to the requested one.</p><p>To obtain this patch, we need to generate the iOS and Android apps from the templates embedded in the <code>react-native</code> package inside your <code>node_modules</code> directory, exactly like the <code>init</code> and <code>upgrade</code> commands do. Then, after the native apps have been computed from the templates in both current version and requested versions, Git is be able to produce a patch that is completely adapted to your project (i.e. with your app name):</p><div class="prism language-javascript"><span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>

diff <span class="token operator">--</span>git a<span class="token operator">/</span>ios<span class="token operator">/</span>MyAwesomeApp<span class="token operator">/</span>Info<span class="token punctuation">.</span>plist b<span class="token operator">/</span>ios<span class="token operator">/</span>MyAwesomeApp<span class="token operator">/</span>Info<span class="token punctuation">.</span>plist
index e98ebb0<span class="token punctuation">.</span><span class="token punctuation">.</span>2fb6a11 <span class="token number">100644</span>
<span class="token operator">--</span><span class="token operator">-</span> a<span class="token operator">/</span>ios<span class="token operator">/</span>MyAwesomeApp<span class="token operator">/</span>Info<span class="token punctuation">.</span>plist
<span class="token operator">++</span><span class="token operator">+</span> b<span class="token operator">/</span>ios<span class="token operator">/</span>MyAwesomeApp<span class="token operator">/</span>Info<span class="token punctuation">.</span>plist
@@ <span class="token operator">-</span><span class="token number">45</span><span class="token punctuation">,</span><span class="token number">7</span> <span class="token operator">+</span><span class="token number">45</span><span class="token punctuation">,</span><span class="token number">7</span> @@
         &lt;dict<span class="token operator">&gt;</span>
             &lt;key<span class="token operator">&gt;</span>localhost&lt;<span class="token operator">/</span>key<span class="token operator">&gt;</span>
             &lt;dict<span class="token operator">&gt;</span>
<span class="token operator">-</span>                &lt;key<span class="token operator">&gt;</span>NSTemporaryExceptionAllowsInsecureHTTPLoads&lt;<span class="token operator">/</span>key<span class="token operator">&gt;</span>
<span class="token operator">+</span>                &lt;key<span class="token operator">&gt;</span>NSExceptionAllowsInsecureHTTPLoads&lt;<span class="token operator">/</span>key<span class="token operator">&gt;</span>
                 &lt;<span class="token boolean">true</span><span class="token operator">/</span><span class="token operator">&gt;</span>
             &lt;<span class="token operator">/</span>dict<span class="token operator">&gt;</span>
         &lt;<span class="token operator">/</span>dict<span class="token operator">&gt;</span>

<span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span></div><p>All we need now is to apply this patch on your current source files. While the old process would have prompted you for any difference (even from a single character), Git is able to merge most of the changes automatically, fallback on a 3-way merge and eventually leave familiar conflict delimiters:</p><div class="prism language-javascript">        13B07F951A680F5B00A75B9A <span class="token comment" spellcheck="true">/* Release */</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
            isa <span class="token operator">=</span> XCBuildConfiguration<span class="token punctuation">;</span>
            buildSettings <span class="token operator">=</span> <span class="token punctuation">{</span>
                ASSETCATALOG_COMPILER_APPICON_NAME <span class="token operator">=</span> AppIcon<span class="token punctuation">;</span>
&lt;&lt;&lt;&lt;&lt;&lt;&lt; ours
                CODE_SIGN_IDENTITY <span class="token operator">=</span> <span class="token string">&quot;iPhone Developer&quot;</span><span class="token punctuation">;</span>
                FRAMEWORK_SEARCH_PATHS <span class="token operator">=</span> <span class="token punctuation">(</span>
                    <span class="token string">&quot;$(inherited)&quot;</span><span class="token punctuation">,</span>
                    <span class="token string">&quot;$(PROJECT_DIR)/HockeySDK.embeddedframework&quot;</span><span class="token punctuation">,</span>
                    <span class="token string">&quot;$(PROJECT_DIR)/HockeySDK-iOS/HockeySDK.embeddedframework&quot;</span><span class="token punctuation">,</span>
                <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">===</span><span class="token operator">===</span><span class="token operator">=</span>
                CURRENT_PROJECT_VERSION <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token operator">&gt;</span><span class="token operator">&gt;</span><span class="token operator">&gt;</span><span class="token operator">&gt;</span><span class="token operator">&gt;</span><span class="token operator">&gt;</span><span class="token operator">&gt;</span> theirs
                HEADER_SEARCH_PATHS <span class="token operator">=</span> <span class="token punctuation">(</span>
                    <span class="token string">&quot;$(inherited)&quot;</span><span class="token punctuation">,</span>
                    <span class="token operator">/</span>Applications<span class="token operator">/</span>Xcode<span class="token punctuation">.</span>app<span class="token operator">/</span>Contents<span class="token operator">/</span>Developer<span class="token operator">/</span>Toolchains<span class="token operator">/</span>XcodeDefault<span class="token punctuation">.</span>xctoolchain<span class="token operator">/</span>usr<span class="token operator">/</span>include<span class="token punctuation">,</span>
                    <span class="token string">&quot;$(SRCROOT)/../node_modules/react-native/React/**&quot;</span><span class="token punctuation">,</span>
                    <span class="token string">&quot;$(SRCROOT)/../node_modules/react-native-code-push/ios/CodePush/**&quot;</span><span class="token punctuation">,</span>
                <span class="token punctuation">)</span><span class="token punctuation">;</span></div><p>These conflicts are generally easy to reason about. The delimiter <strong>ours</strong> actually stands for &quot;your team&quot; whereas <strong>their</strong> could be seen as &quot;the React Native team&quot;.</p><h2><a class="anchor" name="usage"></a>Usage <a class="hash-link" href="#usage">#</a></h2><p>As I mentioned in the <a href="http://facebook.github.io/react-native/releases/next/docs/upgrading.html" target="_blank">Upgrading guide</a>, the most important change concerns the automatic installation of the new <code>react-native</code> package.</p><blockquote><p>You should <strong>not</strong> install the new <code>react-native</code> package by yourself, the upgrading process needs to be initiated on your current version of React Native. Otherwise, the current and requested versions would be the same, Git would produce an empty patch and the upgrade would be ineffective.</p></blockquote><p>Install the <code>react-native-git-upgrade</code> package globally:</p><div class="prism language-javascript">$ npm install <span class="token operator">-</span>g react<span class="token operator">-</span>native<span class="token operator">-</span>git<span class="token operator">-</span>upgrade</div><p>Then, run the <code>react-native-git-upgrade</code> command with an optional version (latest if not specified) inside your project directory:</p><p><img src="/react-native/blog/img/git-upgrade-output.png" alt=""></p><blockquote><p>Git needs to be available in the <code>PATH</code>.</p></blockquote><p>Note that this new upgrade method aims at preserving your changes in your native files, so you don&#x27;t need to run <code>react-native link</code> after an upgrade.</p><p>I have designed the implementation to be as less intrusive as possible. It is entirely based on a local Git repository created on-the-fly in the system temporary directory. It won&#x27;t interfere with your project repository (no matter the VCS you use: Git, SVN, Mercurial, ... or none). Your sources are restored in case of unexpected errors.</p><h2><a class="anchor" name="why-a-separated-package"></a>Why a separated package ? <a class="hash-link" href="#why-a-separated-package">#</a></h2><p>React Native comes with a global CLI (the <a href="https://www.npmjs.com/package/react-native-cli" target="_blank">react-native-cli</a> package) which delegates the command to the local CLI embedded in the <code>node_modules/react-native/local-cli</code> directory.</p><p>As I mentioned above, the process has to be started upon your current React Native version. If we had embedded the implementation in the local-cli, you wouldn&#x27;t have been able to enjoy this feature until the upcoming React Native release was in use on your project.</p><p>This Git upgrading feature is a huge improvement in developer experience and I really wanted it to be available for any users including those who are stuck in old versions of React Native (who said 0.28 ?) because of the painful upgrading process. That&#x27;s why we came with the <a href="https://www.npmjs.com/package/react-native-git-upgrade" target="_blank">react-native-git-upgrade</a> package, installed globally, no matter the version of React Native being used.</p><p>An other reason is the recent <a href="https://twitter.com/martinkonicek/status/800730190141857793" target="_blank">Yeoman wipeout</a> by Martin Konicek. We didn&#x27;t want to get these Yeoman dependencies back into the <code>react-native</code> package !</p><h2><a class="anchor" name="about-the-future"></a>About the future <a class="hash-link" href="#about-the-future">#</a></h2><p>The standalone package is a temporary situation for a few months, it would probably never see the <em>1.0.0</em> release: when most users will have migrated their projects to the <em>post-Yeoman era</em> using this package, it will replace the actual <code>react-native upgrade</code> and the global package <code>react-native-git-upgrade</code> will be deprecated.</p><p>As a conclusion, I would say, enjoy the feature and feel free <a href="https://github.com/facebook/react-native/issues" target="_blank">to suggest improvements, report issues and send pull requests</a>. Each user has its own runtime environment, each React Native project is different, so we need you to make this process completely reliable and universal !</p></div></div><div><aside class="author-info"><div class="author-image"><span class="the-image" style="background-image:url(https://fr.gravatar.com/userimage/78328995/184460def705a160fd8edadc04f60eaf.jpg?size=128);"></span></div><p class="posted-on">Posted on <time class="date">December 5, 2016</time></p><p class="name-title"><a href="https://twitter.com/ncuillery" target="_blank">Nicolas Cuillery</a>, <span class="title">JavaScript consultant and trainer at Zenika</span></p></aside><aside class="entry-share"><h3 class="small-title">Share this post</h3><div class="social-buttons"><div class="fb-like" data-layout="standard" data-share="true" data-width="225" data-show-faces="false"></div><a href="https://twitter.com/share" class="twitter-share-button" data-text="Easy upgrades, relying on Git" data-url="http://facebook.github.io/react-native/blog/2016/12/05/easy-upgrades-processed-by-git.html" data-via="ncuillery" data-related="reactnative" data-show-count="false">Tweet</a></div></aside></div></article></section><footer class="nav-footer"><section class="sitemap"><a href="/react-native" class="nav-home"><img src="img/header_logo.png" alt="React Native" width="66" height="58"></a><div><h5><a href="docs/">Docs</a></h5><a href="docs/getting-started.html">Getting Started</a><a href="docs/tutorial.html">Tutorial</a><a href="docs/integration-with-existing-apps.html">Integration With Existing Apps</a><a href="docs/more-resources.html">More Resources</a></div><div><h5><a href="/react-native/support.html">Community</a></h5><a href="/react-native/showcase.html">Showcase</a><a href="http://www.meetup.com/topics/react-native/" target="_blank">Upcoming Events</a><a href="https://www.facebook.com/groups/react.native.community" target="_blank">Facebook Group</a><a href="https://twitter.com/reactnative" target="_blank">Twitter</a></div><div><h5><a href="/react-native/support.html">Help</a></h5><a href="http://stackoverflow.com/questions/tagged/react-native" target="_blank">Stack Overflow</a><a href="https://discord.gg/0ZcbPKXt5bZjGY5n">Reactiflux Chat</a><a href="/react-native/versions.html" target="_blank">Latest Releases</a><a href="https://productpains.com/product/react-native/" target="_blank">Feature Requests</a></div><div><h5>More</h5><a href="/react-native/blog">Blog</a><a href="https://github.com/facebook/react-native" target="_blank">GitHub</a><a href="http://facebook.github.io/react/" target="_blank">React</a></div></section><section class="newsletter"><div id="mc_embed_signup"><form action="//reactnative.us10.list-manage.com/subscribe/post?u=db0dd948e2b729ee62625b1a8&amp;id=47cd41008f" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate><div id="mc_embed_signup_scroll"><label for="mce-EMAIL"><h5>Get the React Native Newsletter</h5></label><input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required><div style="position:absolute;left:-5000px;" aria-hidden="true"><input type="text" name="b_db0dd948e2b729ee62625b1a8_47cd41008f" tabindex="-1" value=""></div><div class="clear"><input type="submit" value="Sign up" name="subscribe" id="mc-embedded-subscribe" class="button"></div></div></form></div></section><a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource"><img src="img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"></a><section class="copyright">Copyright Â© 2016 Facebook Inc.</section></footer></div><div id="fb-root"></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
            ga('create', 'UA-41298772-2', 'facebook.github.io');
            ga('send', 'pageview');

            !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)
            ){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";
            fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");

            docsearch({
              apiKey: '2c98749b4a1e588efec53b2acec13025',
              indexName: 'react-native-versions',
              inputSelector: '#algolia-doc-search',
              algoliaOptions: { facetFilters: [ "tags:master" ], hitsPerPage: 5 }
            });
          </script><script src="js/scripts.js"></script><script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script><script type="text/javascript">(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';fnames[1]='FNAME';ftypes[1]='text';fnames[2]='LNAME';ftypes[2]='text';}(jQuery));var $mcj = jQuery.noConflict(true);</script></body></html>